<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Meaning.ai</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font, as per standard instruction -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles based on the images, emphasizing cute, rounded, and pink aesthetic */
        body {
            font-family: 'Inter', sans-serif;
            transition: background-image 1s ease-in-out;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        /* Custom color palette approximation */
        .pink-primary { background-color: #ffb6c1; } /* Light Pink */
        .pink-text { color: #ff69b4; } /* Hot Pink/Deep Pink */
        .pink-border { border-color: #ff69b4; }

        /* Style for the filter buttons to match the aesthetic */
        .filter-btn {
            @apply inline-flex items-center px-4 py-2 text-sm font-medium rounded-full transition-all duration-200 cursor-pointer;
            white-space: nowrap;
            color: #64748b; /* slate-500 */
            background-color: #fce7f3; /* pink-100 */
            border: 2px solid transparent;
        }
        .filter-btn:hover {
            @apply shadow-md scale-[1.02];
            background-color: #fbcfe8; /* pink-200 */
        }
        .filter-btn.active {
            @apply text-white font-semibold shadow-lg;
            background-color: #ff69b4; /* Hot Pink/Deep Pink */
            border: 2px solid #ff1493; /* Deepest Pink */
        }

        /* Card styles */
        .meaning-card {
            @apply p-4 bg-white rounded-xl shadow-lg transition-all duration-300 transform cursor-pointer;
            min-height: 180px;
        }
        .meaning-card:hover {
            @apply shadow-xl ring-4 ring-pink-300 scale-[1.03];
        }
        .meaning-card-title {
            @apply text-lg font-semibold mb-1;
            color: #ff69b4; /* Hot Pink */
        }
        .meaning-card-subtitle {
            @apply text-sm text-gray-500 italic;
        }
        .meaning-card-tags {
             @apply mt-2 text-xs font-medium text-pink-500 uppercase;
        }
        .meaning-card-icon {
            font-size: 2rem; /* Large icon size */
            line-height: 1;
        }

        /* Modal styles */
        .modal-overlay {
            z-index: 1000;
            backdrop-filter: blur(8px);
            background-color: rgba(255, 255, 255, 0.8); /* Semi-transparent white overlay */
            transition: opacity 0.3s ease;
        }
        .modal-content {
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
        }

    </style>
</head>

<body id="app-body">
    <!-- Header/Navigation -->
    <header class="p-4 md:p-8 sticky top-0 bg-white/90 backdrop-blur-sm z-50 shadow-md">
        <div class="max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
            <!-- Logo/Title -->
            <div class="flex items-center text-3xl font-bold pink-text">
                <span role="img" aria-label="Envelope" class="text-4xl mr-2">ðŸ’Œ</span>
                Welcome to Meaning.ai
            </div>

            <!-- Classifiers/Filters -->
            <div id="filter-container" class="flex flex-wrap justify-center gap-2">
                <button data-filter="all" class="filter-btn active">
                    <span class="mr-1">ðŸ’–</span> All
                </button>
                <!-- These buttons will be generated by JS based on card data -->
            </div>
        </div>
    </header>

    <!-- Main Content Grid -->
    <main class="max-w-6xl mx-auto p-4 md:p-8">
        <div id="meaning-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
            <!-- Meaning Cards will be injected here -->
        </div>
    </main>

    <!-- Modal for Detailed View -->
    <div id="meaning-modal" class="modal-overlay hidden fixed inset-0 flex items-center justify-center p-4">
        <div id="modal-content-container" class="modal-content w-full md:w-4/5 lg:w-3/5 xl:w-2/5 bg-white rounded-2xl shadow-2xl p-6 md:p-8 relative transform scale-100 transition-transform duration-300">
            <!-- Modal close button -->
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-500 hover:text-pink-500 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>

            <!-- Content Placeholder -->
            <div id="modal-image-placeholder" class="mb-4 rounded-lg overflow-hidden h-40 md:h-64 flex items-center justify-center bg-gray-100">
                <img id="modal-image" src="" alt="Associated image" class="w-full h-full object-cover" onerror="this.onerror=null;this.src='https://placehold.co/600x400/ffe4e1/ff69b4?text=Image+Not+Found';" />
            </div>

            <h2 id="modal-title" class="text-3xl font-bold text-center mb-2 pink-text"></h2>
            <p id="modal-meaning" class="text-xl text-center mb-4 italic text-gray-700"></p>
            <div id="modal-description" class="text-base text-gray-600 leading-relaxed border-t pt-4 border-pink-200"></div>
            <div id="modal-tags" class="mt-4 text-xs font-medium text-center text-pink-500 uppercase"></div>
        </div>
    </div>

    <script>
        // Global variables for Firebase configuration (must be present even if unused in this simple demo)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        // Data for the meaning cards (mimicking the content in the images)
        const meanings = [
            {
                id: 1,
                icon: "ðŸŒ™",
                title: `"The moon is lovely, isn't it?"`,
                meaning: `"I love you." (in a poetic, indirect way)`,
                tags: ["Japanese", "Confession"],
                full_description: "A famous translation of 'I love you' by the Japanese novelist Soseki Natsume. It's a reserved, poetic way to express deep affection without explicit declaration.",
                image_url: "https://placehold.co/600x400/f0f8ff/4682b4?text=Moonlit+Scenery"
            },
            {
                id: 2,
                icon: "ðŸ’˜", // Changed icon to be less intense, but kept the original feeling
                title: `"I want to eat your pancreas"`,
                meaning: `"I want to be with you forever"`,
                tags: ["Japanese", "Forever Like"],
                full_description: "From the Japanese novel and film *Kimi no SuizÅ o Tabetai*. The phrase conveys a deep, beautiful sentiment, believed that consuming part of someone will allow their spirit to live with you forever. It implies a desire to be with them for eternity.",
                image_url: "https://placehold.co/600x400/fff0f5/ff69b4?text=Pancreas+Anime+Scene"
            },
            {
                id: 3,
                icon: "â˜€ï¸",
                title: `"The sunrise is beautiful, isn't it?"`,
                meaning: `"I love you, so don't leave me"`,
                tags: ["Japanese", "Forever Like"],
                full_description: "A desperate and bittersweet confession. While acknowledging beauty, the underlying message is a fear of separation, hoping the shared moment of beauty will bind them together.",
                image_url: "https://placehold.co/600x400/fffacd/daa520?text=Sunrise+View"
            },
            {
                id: 4,
                icon: "ðŸŒ…",
                title: `"The sunset is beautiful, isn't it?"`,
                meaning: `"I love you, but I'm letting go"`,
                tags: ["Japanese", "Goodbye"],
                full_description: "The phrase is often used to mean, 'I love you, but I'm letting go.' It's a bittersweet sentiment, acknowledging the beauty of a moment while understanding that it must come to an end. It is a romantic and respectful way to say goodbye.",
                image_url: "https://placehold.co/600x400/faebd7/cd5c5c?text=Sunset+View" // Example from the fourth uploaded image
            },
            {
                id: 5,
                icon: "ðŸœ",
                title: `"Want to eat ramen together?"`,
                meaning: `A casual date invitation`,
                tags: ["Korean", "Confession"],
                full_description: "In Korean dramas and culture (e.g., 'Ramyun meokgo gallae?'), this phrase is often a subtly suggestive or casual invitation that means 'Do you want to come back to my place?' or just a simple, low-pressure first date.",
                image_url: "https://placehold.co/600x400/ffe4e1/a52a2a?text=Ramen+Bowl"
            },
            {
                id: 6,
                icon: "ðŸš©",
                title: `"Raising a white flag"`,
                meaning: `Giving up on love or surrendering emotionally`,
                tags: ["Japanese", "Goodbye"],
                full_description: "A direct metaphor for surrender, meaning the speaker is emotionally exhausted or acknowledging that the relationship battle is lost, choosing to wave the white flag and step away.",
                image_url: "https://placehold.co/600x400/f0f8ff/4682b4?text=White+Flag"
            },
            {
                id: 7,
                icon: "âš™ï¸",
                title: `"Fireworks scene"`,
                meaning: `A fleeting, beautiful memory of love`,
                tags: ["Japanese", "Korean", "Memory"],
                full_description: "In East Asian media, the short, intense beauty of fireworks is often used to symbolize a brief but unforgettable romantic moment or a sudden, dramatic confession.",
                image_url: "https://placehold.co/600x400/000080/ffdab9?text=Fireworks+Night"
            },
            {
                id: 8,
                icon: "ðŸ”´",
                title: `"Red Thread of Fate"`,
                meaning: `You're destined to meet no matter what`,
                tags: ["Chinese", "Japanese", "Destiny"],
                full_description: "An East Asian belief that the gods tie an invisible red cord around the ankles of those who are destined to meet each other in a certain situation, regardless of time, place, or circumstance.",
                image_url: "https://placehold.co/600x400/fa8072/8b0000?text=Red+Thread+of+Fate"
            },
            {
                id: 9,
                icon: "â¤ï¸",
                title: `"SOS"`,
                meaning: `"The thing keeping you alive and killing you"`,
                tags: ["English", "Forever Like"],
                full_description: "A modern interpretation used in romantic contexts, often referring to a person or a feeling that is both necessary for emotional life and intensely painful or difficult, creating a state of constant emotional emergency.",
                image_url: "https://placehold.co/600x400/ffe4e1/b22222?text=Heart+Icon"
            },
            {
                id: 10,
                icon: "ðŸ‘†",
                title: `"Touching forehead or patting head"`,
                meaning: `A sign of fondness`,
                tags: ["Japanese", "Confession"],
                full_description: "A non-verbal action often seen in anime/manga/K-dramas, signifying deep affection, comfort, or a protective gesture. It's a gentle, intimate form of non-verbal confession or affirmation of care.",
                image_url: "https://placehold.co/600x400/f0f8ff/87cefa?text=Head+Pat"
            }
        ];

        // --- BACKGROUND LOGIC ---
        const backgroundUrls = [
            // New set of URLs provided by the user
            'https://i.pinimg.com/73x/da/22/29/da2229bc74bde83d8a2213c341deb2e1.jpg',
            'https://i.pinimg.com/73x/05/55/7f/05557fe78a4329ab861a29e2f6598688.jpg',
            'https://i.pinimg.com/73x/cc/01/15/cc0115d36223588776b2c018c08a88c4.jpg',
            'https://i.pinimg.com/73x/82/73/8f/82738f17969ab96336601283d7fcfe7d.jpg',
            'https://i.pinimg.com/73x/e2/ff/0d/e2ff0d30439c913ca990bce75f7bbd64.jpg',
            'https://i.pinimg.com/1200x/4b/0f/17/4b0f174b6296389f9417a03d2ba61cc3.jpg',
            'https://i.pinimg.com/73x/d6/cb/02/d6cb0273364381e6379a77ef590038d4.jpg',
            'https://i.pinimg.com/73x/e1/f4/63/e1f46381bded7aa0db89b9e5b03b77b3.jpg',
            'https://i.pinimg.com/73x/43/2a/ef/432aefd19425902e6454d0825a9399f6.jpg'
        ];

        function setRandomBackground(elementId = 'app-body') {
            const body = document.getElementById(elementId);
            if (!body) return;

            // Get a random URL index
            const randomIndex = Math.floor(Math.random() * backgroundUrls.length);
            const randomUrl = backgroundUrls[randomIndex];

            // Set the background-image CSS property
            body.style.backgroundImage = `url('${randomUrl}')`;

            // Store the current background URL in session storage
            sessionStorage.setItem('currentBgUrl', randomUrl);
        }

        // --- FILTERING LOGIC ---
        let currentFilter = 'all';

        function getUniqueTags() {
            const allTags = meanings.flatMap(m => m.tags);
            return [...new Set(allTags)];
        }

        function createFilterButtons() {
            const tags = getUniqueTags();
            const container = document.getElementById('filter-container');

            tags.forEach(tag => {
                const button = document.createElement('button');
                button.setAttribute('data-filter', tag);
                button.className = 'filter-btn';
                button.innerHTML = `<span>${tag}</span>`; // Simple text label for tags

                // Assign icon based on filter for better aesthetic
                let icon = 'ðŸ”–';
                if (tag === 'Confession') icon = 'ðŸ’–';
                else if (tag === 'Goodbye') icon = 'ðŸ‘‹';
                else if (tag === 'Memory') icon = 'ðŸ’­';
                else if (tag === 'Destiny') icon = 'ðŸ’«';
                else if (tag === 'Forever Like') icon = 'ðŸ’˜';

                button.innerHTML = `<span class="mr-1">${icon}</span> ${tag}`;

                button.addEventListener('click', () => {
                    filterMeanings(tag);
                });
                container.appendChild(button);
            });
        }

        function renderMeanings(filter) {
            const grid = document.getElementById('meaning-grid');
            grid.innerHTML = ''; // Clear existing content

            const filteredMeanings = filter === 'all'
                ? meanings
                : meanings.filter(m => m.tags.includes(filter));

            filteredMeanings.forEach(meaning => {
                const card = document.createElement('div');
                card.className = 'meaning-card';
                card.setAttribute('data-tags', meaning.tags.join(','));
                card.setAttribute('data-id', meaning.id);
                card.onclick = () => openModal(meaning);

                // Create a random background color for the card's inner area (mimicking the image)
                const randomCardBgUrl = backgroundUrls[Math.floor(Math.random() * backgroundUrls.length)];
                
                // Card HTML structure
                card.innerHTML = `
                    <div class="flex items-start mb-3">
                        <span class="meaning-card-icon mr-3">${meaning.icon}</span>
                        <div>
                            <p class="meaning-card-title">${meaning.title}</p>
                            <p class="meaning-card-subtitle">${meaning.meaning}</p>
                        </div>
                    </div>
                    <div class="meaning-card-tags">
                        ${meaning.tags.join(' / ')}
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function filterMeanings(filter) {
            currentFilter = filter;
            const buttons = document.querySelectorAll('.filter-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-filter') === filter) {
                    btn.classList.add('active');
                }
            });
            renderMeanings(filter);
        }

        // --- MODAL LOGIC ---

        function openModal(meaning) {
            const modal = document.getElementById('meaning-modal');
            const modalContentContainer = document.getElementById('modal-content-container');
            
            // Set Modal Content
            document.getElementById('modal-title').innerText = meaning.title;
            document.getElementById('modal-meaning').innerText = meaning.meaning;
            document.getElementById('modal-description').innerText = meaning.full_description;
            document.getElementById('modal-tags').innerText = meaning.tags.join(' / ');
            document.getElementById('modal-image').src = meaning.image_url;

            // Set Random Background on the Modal Content Container
            // FIX: Corrected typo 'nst' to 'Math.random()'
            const randomIndex = Math.floor(Math.random() * backgroundUrls.length);
            const randomUrl = backgroundUrls[randomIndex];

            // Use a specific image for the "pancreas" example to match the user's image, if possible
            if (meaning.id === 2) {
                // This URL is a placeholder as I cannot access the actual image URL from the upload,
                // so I'm using a simple placehold.co link for consistency in the demo.
                document.getElementById('modal-image').src = 'https://placehold.co/600x400/90c7f0/ffffff?text=I+Want+To+Eat+Your+Pancreas';
            }
            
            // Apply the random background style to the modal container itself
            modalContentContainer.style.backgroundImage = `url('${randomUrl}')`;
            modalContentContainer.style.backgroundSize = 'cover';
            modalContentContainer.style.backgroundPosition = 'center';
            modalContentContainer.style.backgroundAttachment = 'local'; // Should scroll with content

            // Show the modal
            modal.classList.remove('hidden');
        }

        function closeModal() {
            const modal = document.getElementById('meaning-modal');
            modal.classList.add('hidden');
            // Reset image src to clear any errors
            document.getElementById('modal-image').src = '';
        }

        // Close modal on outside click
        document.getElementById('meaning-modal').addEventListener('click', (e) => {
            if (e.target.id === 'meaning-modal') {
                closeModal();
            }
        });


        // --- INITIALIZATION ---
        window.onload = function() {
            // 1. Set the initial random background for the body
            setRandomBackground();

            // 2. Create filter buttons dynamically
            createFilterButtons();

            // 3. Render all cards initially
            renderMeanings('all');
        }
    </script>
</body>
</html>
